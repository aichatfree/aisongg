(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[473],{5140:function(e,t,s){Promise.resolve().then(s.bind(s,60018))},60018:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eF}});var r=s(61462),a=s(70265),i=s(41473),l=s(83220),n=s(98855),o=s(93096),c=s(97711);function d(e){let{tabs:t,className:s,rounded:d,onChange:u}=e,[m,x]=(0,a.useState)(0),[h,p]=(0,a.useState)(0),[g,f]=(0,a.useState)(!1),[v,j]=(0,o.Z)(),y=(0,a.useMemo)(()=>{var e;return(null===(e=t.find(e=>e.id===m))||void 0===e?void 0:e.content)||null},[m,t]),b=e=>{e!==m&&!g&&(p(e>m?1:-1),x(e),u&&u())};return(0,r.jsxs)("div",{className:" flex flex-col items-center w-full",children:[(0,r.jsx)("div",{className:(0,c.cn)("flex space-x-1 border border-none rounded-full cursor-pointer bg-neutral-600 px-[3px] py-[3.2px] shadow-inner-shadow",s,d),children:t.map(e=>(0,r.jsxs)("button",{onClick:()=>b(e.id),className:(0,c.cn)("relative rounded-full px-3.5 py-1.5 text-xs sm:text-sm font-medium transition focus-visible:outline-1 focus-visible:ring-1 focus-visible:outline-none flex gap-2 items-center",m===e.id?"text-white bg-gradient-to-r from-purple-600 to-red-500":"hover:text-neutral-300/60 text-neutral-200/80",d),style:{WebkitTapHighlightColor:"transparent"},children:[m===e.id&&(0,r.jsx)(i.E.span,{layoutId:"bubble",className:"absolute  inset-0 z-10 bg-neutral-700 mix-blend-difference shadow-inner-shadow border border-white/10",style:d?{borderRadius:9}:{borderRadius:9999},transition:{type:"spring",bounce:.19,duration:.4}}),e.label]},e.id))}),(0,r.jsx)(l.A,{transition:{duration:.4,type:"spring",bounce:.2},children:(0,r.jsx)(i.E.div,{className:"relative mx-auto w-full h-full overflow-hidden",initial:!1,animate:{height:j.height},children:(0,r.jsx)("div",{className:"p-1",ref:v,children:(0,r.jsx)(n.M,{custom:h,mode:"popLayout",onExitComplete:()=>f(!1),children:(0,r.jsx)(i.E.div,{variants:{initial:e=>({x:300*e,opacity:0}),active:{x:0,opacity:1},exit:e=>({x:-300*e,opacity:0})},initial:"initial",animate:"active",exit:"exit",custom:h,onAnimationStart:()=>f(!0),onAnimationComplete:()=>f(!1),children:y},m)})})})})]})}var u=s(90093),m=s(88362),x=s(93597),h=s(22370),p=s(49600),g=s(95180),f=s(41409),v=s(35160);function j(){let{currentMusicList:e,currentPage:t,selectedMusic:s,handleSetMusicsList:r,handleSetSelectedMusic:a}=(0,u.l)(),{handleSetPlayingMusic:i}=(0,v.c)(),l=(0,m.createClientComponentClient)(),n=e=>{a(e),i(e)},o=async i=>{if(l)try{await (0,h._B)(l,i);let o=e.filter(e=>e.music_id!==i);r(t,o),(null==s?void 0:s.music_id)===i&&(null==o?void 0:o.length)>0?n(o[0]):(null==o?void 0:o.length)===0&&a(null),p.Am.success("Music deleted successfully")}catch(e){p.Am.error("Failed to delete music")}};return{handleSelectMusic:n,handleDeleteMusic:o,handleUpdateMusic:(s,a)=>{r(t,e.map(e=>e.music_id===s?{...e,...a}:e))}}}var y=s(36446);let b=(0,s(99649).j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function w(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,c.cn)(b({variant:s}),t),...a})}var N=s(16391),C=s(29555),_=s(72517),k=s(82774),S=s(89925),A=s(2830),E=s(4382),D=s(82912),O=s(9585),z=s(45424),L=s(85221),F=s(97801),M=s(26352),R=s(67516),U=s(33940),P=s(32159),I=s(34481),T=s(35201),Z=s(54667),q=s(41443),V=s(86648),$=s(82493);function B(e){let{isOpen:t,onClose:s,music:i}=e,[l,n]=(0,a.useState)(!1),{handleSetTaskTrigger:o}=(0,u.l)(),{user:c,fetchUserInfo:d}=(0,a.useContext)(x.S),{openModal:m,handleSetInfo:h}=(0,N.d)(),f=(0,y.tv)(),[v,j]=(0,a.useState)((null==i?void 0:i.title)||""),[b,w]=(0,a.useState)(""),[_,k]=(0,a.useState)((null==i?void 0:i.tags)||""),[S,A]=(0,a.useState)("0:01"),[E,D]=(0,a.useState)(1),O=e=>"".concat(Math.floor(Math.round(e)/60),":").concat((Math.round(e)%60).toString().padStart(2,"0")),z=e=>{let[t,s]=e.split(":").map(Number);if(!isNaN(t)&&!isNaN(s)){let r=60*t+s,a=(null==i?void 0:i.duration)||0;r>=1&&r<=a&&(D(r),A(e))}},L=async()=>{if(!c.has_access){h("Upgrade Required","Please upgrade to a paid plan to extend your song."),m("upgrade");return}if(c.left_credits<g.QS){p.Am.warning("Credits not enough"),f.push("/pricing");return}if(b.length<1||b.length>2998){p.Am.error("lyrics is required and must be between 1 and 3000 characters");return}if(_.length>120){p.Am.error("styles are required and do not exceed the 120 characters limit");return}if(v.length>79){p.Am.error("title is required and do not exceed the 80 characters limit");return}E<1&&D(1),n(!0);try{let e=(null==i?void 0:i.provider)==="my"?"extend/my":"extend",t=await fetch("/api/song/".concat(e),{method:"POST",body:JSON.stringify({audio_id:null==i?void 0:i.original_id,user_id:c.id,user_email:c.email,provider:null==i?void 0:i.provider,is_private:null==i?void 0:i.is_private,is_upload:null==i?void 0:i.is_upload,title:v,lyrics:b,style:_,extend_time:E})});if(!t.ok){let e=await t.text();throw Error(e)}}catch(e){p.Am.error("Error: "+(null==e?void 0:e.message)),n(!1);return}await new Promise(e=>setTimeout(e,2e3)),o(),d(),n(!1),p.Am.success("Extend processing..."),window.location.href="/myworks",s()};return(0,r.jsx)($.Vq,{open:t,onOpenChange:s,children:(0,r.jsxs)($.cZ,{className:"sm:max-w-[425px] bg-[#1C1C1C] border-zinc-800 overflow-x-hidden",children:[(0,r.jsx)($.fK,{children:(0,r.jsx)($.$N,{className:"text-md",children:"Extend Your Song"})}),(0,r.jsxs)(I.Zb,{className:"w-full bg-zinc-900 border-zinc-800",children:[(0,r.jsxs)(I.aY,{className:"space-y-8 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-6",children:[(0,r.jsx)("img",{src:(null==i?void 0:i.image)||"/logo.png",alt:(null==i?void 0:i.title)||"AI Song Generator",className:"w-16 h-16 sm:w-20 sm:h-20 rounded-xl object-cover shadow-xl flex-shrink-0"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h3",{className:"text-xs sm:text-sm font-semibold text-white truncate",children:null==i?void 0:i.title}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Select where to continue from"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-300",children:"Extend from"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(T.I,{value:S,onChange:e=>z(e.target.value),className:"w-16 h-6 text-white text-xs text-right bg-zinc-800 border-zinc-700"}),(0,r.jsxs)("span",{className:"text-sm text-gray-400 min-w-[60px]",children:["/ ",(null==i?void 0:i.duration)?O(i.duration):"0:00"]})]})]}),(0,r.jsx)("input",{type:"range",min:"1",max:(null==i?void 0:i.duration)||0,step:"0.01",value:E,onChange:e=>{let t=Number(e.target.value);D(t),A(O(t))},className:"w-full h-2 rounded-full appearance-none cursor-pointer bg-zinc-700",style:{backgroundImage:"linear-gradient(to right, #3b82f6 ".concat((60*Number(S.split(":")[0])+Number(S.split(":")[1]))/((null==i?void 0:i.duration)||1)*100,"%, #3f3f46 ").concat((60*Number(S.split(":")[0])+Number(S.split(":")[1]))/((null==i?void 0:i.duration)||1)*100,"%)")}})]})]}),(0,r.jsx)(I.eW,{className:"flex flex-col border-t border-zinc-800 mt-4",children:(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-400",children:"Extend your song allows you to seamlessly continue your music from the selected point."})})]}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"title",children:"Title"}),(0,r.jsx)(T.I,{id:"title",value:v,onChange:e=>j(e.target.value),className:"text-xs",placeholder:"Enter the title you want to extend"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"lyrics",children:"Lyrics"}),(0,r.jsx)(q.g,{id:"lyrics",value:b,onChange:e=>w(e.target.value),placeholder:"Enter the lyrics you want to extend",className:"text-xs min-h-[150px]"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"style",children:"Style"}),(0,r.jsx)(q.g,{id:"style",value:_,onChange:e=>k(e.target.value),placeholder:"Enter the style you want to extend",className:"text-xs min-h-[100px]"})]})]}),(0,r.jsx)($.cN,{className:"flex flex-col sm:flex-row gap-3 justify-end",children:(0,r.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full justify-center items-center",children:[(0,r.jsx)(C.z,{onClick:s,className:"px-4 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-800 transition-colors w-full sm:w-auto",children:"Cancel"}),(0,r.jsx)(C.z,{onClick:L,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors w-full sm:w-auto",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.Z,{className:"animate-spin mr-2 text-sm"}),"Extending..."]}):"Start Extend"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"This action will consume 3 credits"})]})})]})})}function W(e){let{isOpen:t,onClose:s,music:i}=e,[l,n]=(0,a.useState)(!1),{handleSetTaskTrigger:o}=(0,u.l)(),{user:c,fetchUserInfo:d}=(0,a.useContext)(x.S),{openModal:m,handleSetInfo:h}=(0,N.d)(),f=(0,y.tv)(),[v,j]=(0,a.useState)("".concat(null==i?void 0:i.title,"(Cover)")||0),[b,w]=(0,a.useState)((null==i?void 0:i.prompt)||""),[_,k]=(0,a.useState)((null==i?void 0:i.tags)||""),S=async()=>{if(!c.has_access){h("Upgrade Required","Please upgrade to a paid plan to generate cover."),m("upgrade");return}if(c.left_credits<g.Ru){p.Am.warning("Credits not enough"),f.push("/pricing");return}if(b.length<1||b.length>2998){p.Am.error("lyrics is required and must be between 1 and 3000 characters");return}if(_.length>120){p.Am.error("styles are required and do not exceed the 120 characters limit");return}if(v.length>78){p.Am.error("title is required and do not exceed the 80 characters limit");return}n(!0);try{let e=(null==i?void 0:i.provider)==="my"?"cover/my":"cover",t=await fetch("/api/song/".concat(e),{method:"POST",body:JSON.stringify({audio_id:null==i?void 0:i.original_id,user_id:c.id,user_email:c.email,provider:null==i?void 0:i.provider,is_private:null==i?void 0:i.is_private,is_upload:null==i?void 0:i.is_upload,title:v,lyric:b,style:_})});if(!t.ok){let e=await t.text();throw Error(e)}}catch(e){p.Am.error("This song is not available for cover"),n(!1);return}await new Promise(e=>setTimeout(e,2e3)),o(),d(),n(!1),p.Am.success("Cover processing..."),window.location.href="/myworks",s()};return(0,r.jsx)($.Vq,{open:t,onOpenChange:s,children:(0,r.jsxs)($.cZ,{className:"sm:max-w-[425px] bg-[#1C1C1C] border-zinc-800 overflow-x-hidden",children:[(0,r.jsx)($.fK,{children:(0,r.jsx)($.$N,{className:"text-md",children:"Generate Cover"})}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"title",children:"Title"}),(0,r.jsx)(T.I,{id:"title",value:v,onChange:e=>j(e.target.value),className:"text-xs",placeholder:"Enter the title"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"lyrics",children:"Lyrics"}),(0,r.jsx)(q.g,{id:"lyrics",value:b,onChange:e=>w(e.target.value),placeholder:"Enter the lyrics",className:"text-xs min-h-[250px] leading-6"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"style",children:"Style"}),(0,r.jsx)(q.g,{id:"style",value:_,onChange:e=>k(e.target.value),placeholder:"Enter the style",className:"text-xs min-h-[100px]"})]})]}),(0,r.jsx)($.cN,{className:"flex flex-col sm:flex-row gap-3 justify-end",children:(0,r.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full justify-center items-center",children:[(0,r.jsx)(C.z,{onClick:s,className:"px-4 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-800 transition-colors w-full sm:w-auto",children:"Cancel"}),(0,r.jsx)(C.z,{onClick:S,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors w-full sm:w-auto",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.Z,{className:"animate-spin mr-2 text-sm"}),"Covering..."]}):"Start Cover"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"This action will consume 3 credits"})]})})]})})}var K=s(44049),X=s(47473),Y=s(63552);function J(e){return(e||"untitled").replace(/[/\\?%*:|"<>]/g,"-")}function G(e){let{isDeleteModalOpen:t,setIsDeleteModalOpen:s,handleConfirmDelete:a}=e;return(0,r.jsx)(K.aR,{open:t,onOpenChange:s,children:(0,r.jsxs)(K._T,{className:"bg-[#1C1C1C] border-zinc-800",children:[(0,r.jsxs)(K.fY,{children:[(0,r.jsx)(K.f$,{className:"text-white",children:"Are you sure you want to delete this music?"}),(0,r.jsx)(K.yT,{className:"text-red-500",children:"This action cannot be undone. This will permanently delete your music."})]}),(0,r.jsxs)(K.xo,{children:[(0,r.jsx)(K.le,{className:"text-green-500",children:"Cancel"}),(0,r.jsx)(K.OL,{className:"text-red-500 hover:text-red-600",onClick:a,children:"Delete"})]})]})})}function H(e){let{isPaid:t,isDialogOpen:s,setIsDialogOpen:i}=e,l=(0,m.createClientComponentClient)(),{openModal:n,handleSetInfo:o}=(0,N.d)(),{handleUpdateMusic:c}=j(),{selectedMusic:d}=(0,u.l)(),[x,g]=(0,a.useState)({title:"",style:"",lyrics:""});(0,a.useEffect)(()=>{s&&d&&g({title:d.title||"",style:d.tags||"",lyrics:d.prompt||""})},[s,d]);let f=async()=>{if(!t){i(!1),o("Upgrade Required","You need to upgrade to a paid plan to edit this song details"),n("upgrade");return}await (0,h.RC)(l,[{music_id:null==d?void 0:d.music_id,title:x.title,tags:x.style,prompt:x.lyrics}]),d&&c(d.music_id,{...d,title:x.title,tags:x.style,prompt:x.lyrics}),i(!1),p.Am.success("Song updated successfully.")};return(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)($.Vq,{open:s,onOpenChange:i,children:(0,r.jsxs)($.cZ,{className:"sm:max-w-[425px] bg-[#1C1C1C] border-zinc-800",children:[(0,r.jsx)($.fK,{children:(0,r.jsx)($.$N,{className:"text-md",children:"Edit Song"})}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{htmlFor:"title",className:"text-sm",children:"Title"}),(0,r.jsx)(T.I,{id:"title",value:x.title,className:"text-xs",onChange:e=>g(t=>({...t,title:e.target.value}))})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{htmlFor:"style",className:"text-sm",children:"Style"}),(0,r.jsx)(T.I,{id:"style",value:x.style,className:"text-xs",onChange:e=>g(t=>({...t,style:e.target.value}))})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{htmlFor:"lyrics",className:"text-sm",children:"Lyrics"}),(0,r.jsx)(q.g,{id:"lyrics",value:x.lyrics,rows:20,className:"text-xs",onChange:e=>g(t=>({...t,lyrics:e.target.value}))})]})]}),(0,r.jsxs)($.cN,{children:[(0,r.jsx)(C.z,{onClick:()=>i(!1),variant:"secondary",children:"Cancel"}),(0,r.jsx)(C.z,{onClick:f,variant:"destructive",children:"Save changes"})]})]})})})}function Q(e){let{isDownloadModalOpen:t,setIsDownloadModalOpen:s,onDownloadMp3:a,onDownloadWav:i,onDownloadSrt:l}=e;return(0,r.jsx)($.Vq,{open:t,onOpenChange:s,children:(0,r.jsxs)($.cZ,{className:"sm:max-w-[425px] bg-[#1C1C1C] border-zinc-800",children:[(0,r.jsx)($.fK,{children:(0,r.jsx)($.$N,{className:"text-md text-white",children:"Download Your Song"})}),(0,r.jsxs)("div",{className:"flex justify-center gap-8 py-6",children:[(0,r.jsxs)(C.z,{onClick:a,variant:"outline",className:"flex flex-col items-center gap-2 h-auto py-4 px-8 text-white border-zinc-700 bg-zinc-800 text-white",children:[(0,r.jsx)(X.Z,{className:"h-8 w-8"}),(0,r.jsx)("span",{children:"MP3"})]}),(0,r.jsxs)(C.z,{onClick:i,variant:"outline",className:"flex flex-col items-center gap-2 h-auto py-4 px-8 text-white border-zinc-700 bg-zinc-800 text-white",children:[(0,r.jsx)(X.Z,{className:"h-8 w-8"}),(0,r.jsx)("span",{children:"WAV"})]})]})]})})}function ee(e){let{isCommercialLicenseModalOpen:t,setIsCommercialLicenseModalOpen:s}=e,a=(0,y.tv)();return(0,r.jsx)($.Vq,{open:t,onOpenChange:e=>{e||s(!1)},children:(0,r.jsx)($.cZ,{className:"flex flex-col gap-0 p-0 bg-[#1C1C1C] border-zinc-800 sm:max-w-6xl sm:max-h-[60vh] [&>button:last-child]:hidden",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-6 flex flex-col order-first sm:order-last h-[60vh] sm:h-auto",children:[(0,r.jsxs)($.fK,{className:"text-left",children:[(0,r.jsx)($.$N,{className:"text-lg sm:text-2xl font-bold mb-4",children:"Get My License Now"}),(0,r.jsx)($.Be,{className:"text-sm sm:text-lg text-emerald-500 mb-8",children:"Exclusive benefit for yearly subscribers"})]}),(0,r.jsxs)("div",{className:"space-y-6 flex-1 overflow-y-auto pr-2",children:[(0,r.jsx)("h3",{className:"text-lg sm:text-xl font-semibold",children:"License Benefits:"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83C\uDFC6"}),(0,r.jsxs)("div",{className:"text-sm sm:text-base",children:[(0,r.jsx)("h4",{className:"font-semibold",children:"Lifetime Ownership"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Keep all music rights forever, even after subscription ends"})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCB0"}),(0,r.jsxs)("div",{className:"text-sm sm:text-base",children:[(0,r.jsx)("h4",{className:"font-semibold",children:"Full Commercial Use"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Monetize your music anywhere with no revenue sharing"})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83C\uDFA8"}),(0,r.jsxs)("div",{className:"text-sm sm:text-base",children:[(0,r.jsx)("h4",{className:"font-semibold",children:"Creative Freedom"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Remix, modify, redistribute and create new works without restrictions"})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC4"}),(0,r.jsxs)("div",{className:"text-sm sm:text-base",children:[(0,r.jsx)("h4",{className:"font-semibold",children:"Complete Usage Rights"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Full rights to songs, lyrics, instrumentals, and all content"})]})]})]})]}),(0,r.jsxs)("div",{className:"pt-6 space-y-4 mt-4 bg-[#1C1C1C] sticky bottom-0",children:[(0,r.jsx)(C.z,{className:"w-full bg-emerald-500 hover:bg-emerald-600",onClick:()=>{s(!1),a.push("/commercial-license")},children:"Get My License"}),(0,r.jsx)(C.z,{variant:"ghost",className:"w-full",onClick:()=>s(!1),children:"Maybe Later"})]})]}),(0,r.jsx)("div",{className:"hidden sm:block overflow-y-auto border-t sm:border-t-0 sm:border-r border-border max-h-[50vh] sm:max-h-none order-last sm:order-first",children:(0,r.jsx)(Y.Z,{})})]})})})}function et(e){let{isOpen:t,onClose:s,music:i}=e,[l,n]=(0,a.useState)(!1),{handleSetTaskTrigger:o}=(0,u.l)(),{user:c,fetchUserInfo:d}=(0,a.useContext)(x.S),m=async()=>{if(n(!0),"my"===i.provider){let e=p.Am.loading("Processing...",{duration:1/0,position:"top-right"});try{let t=await fetch("/api/song/vocal-removal/my",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audio_id:i.original_id,user_id:c.id})});if(!t.ok){let e=await t.json();p.Am.error(e.error||"Failed to get stems");return}let s=await t.json(),r=await fetch(s.download_url);if(!r.ok){p.Am.error("Failed to download stems");return}let a=await r.blob(),l=URL.createObjectURL(a),n=document.createElement("a");n.href=l,n.download="stems_".concat(J(i.title),".zip"),document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(l),p.Am.success("Download completed",{id:e})}catch(t){console.error("Download failed:",t),p.Am.error("Failed to download stems",{id:e})}finally{p.Am.dismiss(e),n(!1),s();return}}try{let e=await fetch("api/song/vocal-removal",{method:"POST",body:JSON.stringify({audio_id:null==i?void 0:i.original_id,identify_id:null==i?void 0:i.identify_id,user_id:c.id,user_email:c.email,is_private:i.is_private,provider:null==i?void 0:i.provider})});if(!e.ok){let t=await e.text();throw Error(t)}d(),o(),p.Am.success("Vocals removal success..."),window.location.href="/myworks"}catch(e){p.Am.error("Error: "+(null==e?void 0:e.message));return}finally{n(!1),s()}};return(0,r.jsx)($.Vq,{open:t,onOpenChange:e=>{e||s()},children:(0,r.jsxs)($.cZ,{className:"bg-[#1C1C1C] border-zinc-800 max-w-[900px]",children:[(0,r.jsxs)($.fK,{children:[(0,r.jsx)($.$N,{className:"text-xl font-semibold",children:"Vocals Removal"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Separate instruments and vocals from your song"})]}),(0,r.jsxs)("div",{className:"p-6 mx-auto",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-end mt-4",children:[(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-800 transition-colors w-full sm:w-auto",children:"Cancel"}),(0,r.jsx)("button",{onClick:m,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors w-full sm:w-auto",children:l?"Processing...":"Start Processing"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mt-2 text-center",children:"This action will consume 2 credits"})]})]})})}function es(e){let{isOpen:t,onClose:s,music:i}=e,{user:l,fetchUserInfo:n}=(0,a.useContext)(x.S),o=(0,y.tv)(),[c,d]=(0,a.useState)(!1),{handleSetTaskTrigger:m}=(0,u.l)(),h=async()=>{if(l.left_credits<g.Pw){p.Am.warning("Credits not enough"),o.push("/pricing");return}d(!0);try{let e=await fetch("/api/song/concat",{method:"POST",body:JSON.stringify({audio_id:null==i?void 0:i.original_id,user_id:l.id,user_email:l.email,provider:null==i?void 0:i.provider,is_private:null==i?void 0:i.is_private,is_edit:null==i?void 0:i.is_edit})});if(!e.ok){let t=await e.text();throw Error(t)}}catch(e){p.Am.error("Error: "+(null==e?void 0:e.message)),d(!1);return}await new Promise(e=>setTimeout(e,1e3)),m(),n(),d(!1),p.Am.success("Merge processing..."),window.location.href="/myworks",s()};return(0,r.jsx)($.Vq,{open:t,onOpenChange:e=>{e||s()},children:(0,r.jsxs)($.cZ,{className:"bg-[#1C1C1C] border-zinc-800 max-w-[900px]",children:[(0,r.jsxs)($.fK,{children:[(0,r.jsx)($.$N,{className:"text-xl font-semibold",children:"Merge your song"}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Merge your song with previous song"})]}),(0,r.jsxs)("div",{className:"p-6 mx-auto",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-end mt-4",children:[(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-800 transition-colors w-full sm:w-auto",children:"Cancel"}),(0,r.jsx)("button",{onClick:h,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors w-full sm:w-auto",children:c?"Processing...":"Start Processing"})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-400 mt-2 text-center",children:["This action will consume ",g.Pw," credits"]})]})]})})}function er(e){let{isOpen:t,onClose:s,music:i}=e,[l,n]=(0,a.useState)(""),[o,d]=(0,a.useState)(!1),{user:u}=(0,a.useContext)(x.S),m=async()=>{if(!l.trim()){p.Am.warning("Please enter your feedback");return}d(!0);try{let e="\n      AISongGenerator.IO用户反馈\n      ━━━━━━━━━━━━━━━━\n      ▫️ 用户ID：".concat(u.id,"\n      ▫️ 用户邮箱：").concat(u.email,"\n      ▫️ 歌曲ID：").concat(null==i?void 0:i.music_id,"\n      ▫️ 反馈内容：").concat(l,"\n      ━━━━━━━━━━━━━━━━\n      ▫️ 歌曲标题：").concat(null==i?void 0:i.title,"\n      ▫️ 歌曲链接：").concat(null==i?void 0:i.audio,"\n      ▫️ 歌曲状态：").concat(null==i?void 0:i.status,"\n      ▫️ 歌曲创建时间：").concat(null==i?void 0:i.created_at,"\n        ").trim();await (0,c.A_)(e),p.Am.success("Thank you for your feedback!"),n(""),s()}catch(e){console.error("Failed to submit feedback:",e),p.Am.error("Failed to submit feedback. Please try again.")}finally{d(!1)}};return(0,r.jsx)($.Vq,{open:t,onOpenChange:s,children:(0,r.jsxs)($.cZ,{className:"bg-[#1C1C1C] border-zinc-800 max-w-[900px]",children:[(0,r.jsxs)($.fK,{children:[(0,r.jsx)($.$N,{className:"text-xl font-semibold",children:"Feedback / Report"}),(0,r.jsx)($.Be,{className:"text-gray-400 mt-2",children:"Please share your feedback or report any issues with this song. Your input helps us improve."}),(0,r.jsx)($.Be,{className:"text-yellow-400 mt-2",children:"If you have any issues with your song, please contact support@aisonggenerator.io for credit compensation."})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)(q.g,{placeholder:"What would you like to tell us about this song?",className:"min-h-[120px] bg-gray-900 border-gray-700 focus:border-purple-500 text-white",value:l,rows:10,onChange:e=>n(e.target.value)}),i&&(0,r.jsx)("div",{className:"mt-2 text-sm text-gray-400",children:(0,r.jsxs)("span",{children:["Song: ",i.title]})})]}),(0,r.jsxs)($.cN,{className:"mt-6 flex justify-end gap-2",children:[(0,r.jsx)(C.z,{onClick:s,className:"border-gray-700 text-gray-200 hover:bg-gray-800 hover:text-white",children:"Cancel"}),(0,r.jsx)(C.z,{onClick:m,className:"bg-purple-600 hover:bg-purple-700 text-white",disabled:o,children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):"Send Feedback"})]})]})})}var ea=s(82060),ei=s(63755);function el(e){let{isOpen:t,onClose:s,music:i}=e,[l,n]=(0,a.useState)(!1),[o,c]=(0,a.useState)(null),[d,m]=(0,a.useState)(10),[h,g]=(0,a.useState)(i.duration/2),[f,v]=(0,a.useState)(i.duration),[j,y]=(0,a.useState)([]),[b,w]=(0,a.useState)(null),[N,_]=(0,a.useState)(!1),[k,S]=(0,a.useState)(0),A=(0,a.useRef)(null),[E,D]=(0,a.useState)(!1),[O,z]=(0,a.useState)(i.title),[L,F]=(0,a.useState)(i.prompt),[M,R]=(0,a.useState)(i.tags),{user:U,fetchUserInfo:P}=(0,a.useContext)(x.S),{handleSetTaskTrigger:I}=(0,u.l)(),B=async()=>{D(!0);try{let e=await fetch("/api/song/edit/my",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:null==U?void 0:U.id,user_email:null==U?void 0:U.email,audio_id:null==i?void 0:i.original_id,is_private:null==i?void 0:i.is_private,title:O,style:M,lyrics:L,start_time:d,end_time:h})});if(!e.ok)throw Error(e.statusText);await e.json(),p.Am.success("Edit task submitted"),I(),P(),window.location.href="/myworks",s()}catch(e){p.Am.error("Failed to submit edit task: ".concat(e.message));return}finally{D(!1)}},W=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;try{y([]);let s=new Audio;s.crossOrigin="anonymous",s.src=e,await new Promise((e,t)=>{s.addEventListener("loadedmetadata",e),s.addEventListener("error",t)}),w(s);let r=new AudioContext,a=await fetch(e);if(!a.ok)throw Error("Failed to fetch audio file");let i=await a.arrayBuffer(),l=await r.decodeAudioData(i);v(l.duration),g(Math.min(30,l.duration));let n=l.getChannelData(0),o=Math.floor(n.length/t),c=[];for(let e=0;e<t;e++){let t=e*o,s=0,r=0;for(let e=0;e<o&&t+e<n.length;e++)s+=Math.abs(n[t+e]),r++;let a=r>0?s/r:0;c.push(a)}let d=Math.max(...c,.01),u=c.map(e=>e/d);return y(u),u}catch(s){console.error("Failed to get audio waveform",s);let e=Array(t).fill(.5);return y(e),e}};(0,a.useEffect)(()=>{if(t)return console.log("musicxxx:",i),(null==i?void 0:i.audio)&&W(i.audio).catch(console.error),()=>{b&&(b.pause(),b.src="",_(!1))}},[null==i?void 0:i.audio,t]);let K=(e,t)=>{n(!0),c(t)},X=()=>{n(!1),c(null)},Y=e=>{if(!l||!A.current)return;let t=A.current.getBoundingClientRect(),s=Math.max(0,Math.min(f,(e.clientX-t.left)/t.width*f));"start"===o?m(Math.min(s,h-1)):"end"===o&&g(Math.max(s,d+1))};(0,a.useEffect)(()=>{if(t)return l&&(window.addEventListener("mousemove",Y),window.addEventListener("mouseup",X)),()=>{window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",X)}},[l,o,d,h,f,t]);let J=e=>{let t=Math.floor(e%60);return"".concat(Math.floor(e/60),":").concat(t<10?"0"+t:t)},G="".concat(d/f*100,"%"),H="".concat(h/f*100,"%"),Q="".concat((h-d)/f*100,"%"),ee=()=>{b&&(b.pause(),b.src="",_(!1)),s()};return(0,r.jsx)($.Vq,{open:t,onOpenChange:ee,children:(0,r.jsxs)($.cZ,{className:"bg-[#1C1C1C] border-zinc-800 sm:max-w-[1000px] md:max-w-[1200px] lg:max-w-[1400px]",children:[(0,r.jsx)($.fK,{children:(0,r.jsx)($.$N,{className:"text-xl font-semibold",children:"Edit Music Section"})}),(0,r.jsx)("div",{className:"space-y-4 px-2",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2 items-center",children:[(0,r.jsx)("p",{className:"text-sm",children:"Selected Time Range"}),(0,r.jsxs)("p",{className:"text-sm text-green-400",children:[J(d)," - ",J(h)]})]})}),(0,r.jsx)("div",{className:"w-full mx-auto px-2",children:(0,r.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-full overflow-hidden h-16 bg-white relative",children:[(0,r.jsx)("div",{className:"w-16 h-16 flex items-center justify-center border-r border-gray-300",children:(0,r.jsx)("button",{className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 text-gray-700 transition-colors",onClick:()=>{if(b){if(N)b.pause(),_(!1);else{k>=b.duration&&(b.currentTime=0,S(0)),b.play(),_(!0);let e=()=>{S(b.currentTime),b.currentTime>=b.duration&&(b.pause(),_(!1),b.removeEventListener("timeupdate",e))};b.addEventListener("timeupdate",e)}}},children:N?(0,r.jsx)(ea.Z,{size:18}):(0,r.jsx)(ei.Z,{size:18})})}),(0,r.jsx)("div",{className:"h-full w-px bg-gray-300"}),(0,r.jsxs)("div",{ref:A,className:"flex-1 h-full bg-white relative cursor-pointer",style:{touchAction:"none"},onClick:e=>{var t;if(!b||l)return;let s=null===(t=A.current)||void 0===t?void 0:t.getBoundingClientRect();if(!s)return;let r=(e.clientX-s.left)/s.width*f;b.currentTime=r,S(r),N||(b.play(),_(!0))},children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-between px-2",children:j.map((e,t)=>{let s=t/j.length*f;return(0,r.jsx)("div",{className:"w-0.5 transition-colors duration-150 ".concat(s<=k?"bg-green-500":"bg-gray-200"),style:{height:"".concat(60*e,"%")}},t)})}),(0,r.jsxs)("div",{className:"absolute top-0 bottom-0 bg-blue-100/30",style:{left:G,width:Q},children:[(0,r.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-[2px] bg-blue-500"}),(0,r.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-[2px] bg-blue-500"}),(0,r.jsx)("div",{className:"absolute left-0 right-0 top-0 h-[2px] bg-blue-500"}),(0,r.jsx)("div",{className:"absolute left-0 right-0 bottom-0 h-[2px] bg-blue-500"})]}),(0,r.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2 w-4 h-4 bg-blue-500 rounded-full cursor-ew-resize shadow-lg hover:scale-110 transition-transform",style:{left:G},onMouseDown:e=>K(e,"start")}),(0,r.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2 w-4 h-4 bg-blue-500 rounded-full cursor-ew-resize shadow-lg hover:scale-110 transition-transform",style:{left:H},onMouseDown:e=>K(e,"end")})]})]})}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"title",children:"Title"}),(0,r.jsx)(T.I,{id:"title",value:O||"",onChange:e=>z(e.target.value),className:"text-xs",placeholder:"Enter the title"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"lyrics",children:"Lyrics"}),(0,r.jsx)(q.g,{id:"lyrics",value:L||"",onChange:e=>F(e.target.value),placeholder:"Enter the lyrics",className:"text-xs min-h-[250px] whitespace-pre-wrap leading-6"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(Z._,{htmlFor:"style",children:"Style"}),(0,r.jsx)(q.g,{id:"style",value:M||"",onChange:e=>R(e.target.value),placeholder:"Enter the style",className:"text-xs min-h-[100px]"})]})]}),(0,r.jsx)($.cN,{className:"flex flex-col sm:flex-row gap-3 justify-end",children:(0,r.jsxs)("div",{className:"w-full flex flex-col gap-2",children:[(0,r.jsx)("p",{className:"text-xs text-red-400 text-center",children:"Note: The lyrics you change must be within the selected time range"}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full justify-center items-center",children:[(0,r.jsx)(C.z,{onClick:ee,className:"px-4 py-2 rounded-lg border border-gray-600 text-gray-300 hover:bg-gray-800 transition-colors w-full sm:w-auto",children:"Cancel"}),(0,r.jsx)(C.z,{onClick:B,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors w-full sm:w-auto",children:E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.Z,{className:"animate-spin mr-2 text-sm"}),"Editing..."]}):"Replace Section"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-400 text-center",children:"This action will consume 3 credits"})]})})]})})}function en(e){let{music:t,handlePrivateChange:s,setIsCommercialLicenseModalOpen:i,onDelete:l}=e,n=(0,y.tv)(),{openModal:o,handleSetInfo:c,handleSetEditMusic:d}=(0,N.d)(),[u,m]=(0,a.useState)(!1),[h,f]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1),[b,w]=(0,a.useState)(!1),[C,I]=(0,a.useState)(!1),[T,Z]=(0,a.useState)(!1),[q,V]=(0,a.useState)(!1),[$,K]=(0,a.useState)(!1),{user:X}=(0,a.useContext)(x.S),Y=async()=>{if(!X.has_access){c("Upgrade Required","Please upgrade to a paid plan to merge your song."),o("upgrade");return}w(!0)},J=async(e,s)=>{let r;e.stopPropagation();try{if(!X.has_access||null===X.has_access){c("Subscribe to convert MIDI","Subscribe to convert your music to MIDI"),o("upgrade");return}p.Am.info("Converting to MIDI...");let e=await fetch("/api/song/download/midi",{method:"POST",body:JSON.stringify({url:t.audio})});if(!e.ok)throw Error("Convert failed with status: ".concat(e.status));let a=await e.blob();r=URL.createObjectURL(a);let i=document.createElement("a");i.href=r,i.download="".concat(s.replace(/[<>:"/\\|?*]/g,""),".mid"),document.body.appendChild(i),i.click(),i.remove()}catch(e){console.error("MIDI conversion failed:",e),p.Am.error(e instanceof Error?e.message:"MIDI conversion failed")}finally{r&&URL.revokeObjectURL(r)}},H=async()=>{await l(t.music_id),Z(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.h_,{open:u,onOpenChange:m,children:[(0,r.jsx)(P.$F,{className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-gray-100 hover:text-gray-500 dark:hover:bg-gray-800 dark:hover:text-gray-400 transition-colors",children:(0,r.jsx)(k.Z,{className:"w-5 h-5"})}),(0,r.jsxs)(P.AW,{className:"w-56 p-1",sideOffset:5,children:[(0,r.jsxs)("div",{className:"mb-1",children:[(0,r.jsxs)(P.Xi,{onClick:()=>{if("my"===t.provider){K(!0);return}p.Am.warning("This feature is temporarily unavailable.")},className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsx)(S.Z,{className:"w-4 h-4 mr-2 text-blue-500"}),(0,r.jsx)("span",{children:"Edit Song Section"})]}),t.is_edit&&"my"!==t.provider&&(0,r.jsxs)(P.Xi,{className:"flex items-center gap-2",onClick:Y,children:[(0,r.jsx)(A.Z,{className:"w-4 h-4 text-red-500"}),"Confirm Edit"]})]}),(0,r.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1 pt-1",children:[(!t.is_edit||"my"===t.provider)&&(0,r.jsxs)(P.Xi,{onClick:()=>j(!0),className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsx)(E.Z,{className:"w-4 h-4 mr-2 text-blue-500"}),(0,r.jsx)("span",{children:"Extend Your Song"})]}),(!t.is_edit||"my"===t.provider)&&(0,r.jsxs)(P.Xi,{onClick:()=>I(!0),className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsx)(D.Z,{className:"w-4 h-4 mr-2 text-blue-500"}),(0,r.jsx)("span",{children:"Generate Cover"})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1 pt-1",children:(0,r.jsxs)(P.Xi,{className:"flex justify-between px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[t.is_private?(0,r.jsx)(O.Z,{className:"w-4 h-4 mr-2 text-gray-500"}):(0,r.jsx)(z.Z,{className:"w-4 h-4 mr-2 text-green-500"}),(0,r.jsx)("span",{children:t.is_private?"Private":"Public"})]}),(0,r.jsx)(_.r,{id:"private-".concat(t.task_id),checked:t.is_private,onCheckedChange:e=>s(t.music_id,e),"aria-label":"Toggle music privacy",className:"data-[state=checked]:bg-blue-500"})]})}),(0,r.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1 pt-1",children:[!t.is_edit&&(0,r.jsxs)(P.Xi,{onClick:()=>{if(!X.has_access){c("Subscribe to vocals removal","Separate your music into two tracks: vocals and instruments. This AI-powered tool helps you extract vocals or create instrumental versions of your songs. Perfect for karaoke, remixes, or music production."),o("upgrade");return}if(X.left_credits<g.O3){p.Am.warning("Credits not enough"),n.push("/pricing");return}f(!0)},className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsx)(L.Z,{className:"w-4 h-4 mr-2 text-purple-500"}),"my"===t.provider?(0,r.jsx)("span",{children:"Get stems"}):(0,r.jsx)("span",{children:"Vocals Removal"})]}),(0,r.jsxs)(P.Xi,{onClick:e=>J(e,t.title),className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsx)(F.Z,{className:"w-4 h-4 mr-2 text-indigo-500"}),(0,r.jsx)("span",{children:"Extract MIDI"})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1 pt-1",children:(0,r.jsxs)(P.Xi,{onClick:()=>i(!0),className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsx)(M.Z,{className:"w-4 h-4 mr-2 text-yellow-500"}),(0,r.jsx)("span",{children:"Commercial License"})]})}),(0,r.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 my-1 pt-1",children:[(0,r.jsxs)(P.Xi,{onClick:()=>V(!0),className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsx)(R.Z,{className:"w-4 h-4 mr-2 text-gray-500"}),(0,r.jsx)("span",{children:"Feedback / Report"})]}),(0,r.jsxs)(P.Xi,{onClick:()=>Z(!0),className:"flex items-center px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md cursor-pointer transition-colors",children:[(0,r.jsx)(U.Z,{className:"w-4 h-4 mr-2 text-red-500"}),(0,r.jsx)("span",{children:"Delete"})]})]})]})]}),(0,r.jsx)(B,{isOpen:v,onClose:()=>j(!1),music:t}),(0,r.jsx)(W,{isOpen:C,onClose:()=>I(!1),music:t}),(0,r.jsx)(es,{isOpen:b,onClose:()=>w(!1),music:t}),(0,r.jsx)(et,{isOpen:h,onClose:()=>f(!1),music:t}),(0,r.jsx)(G,{isDeleteModalOpen:T,setIsDeleteModalOpen:Z,handleConfirmDelete:H}),(0,r.jsx)(er,{isOpen:q,onClose:()=>V(!1),music:t}),(0,r.jsx)(el,{isOpen:$,onClose:()=>K(!1),music:t})]})}var eo=s(41437),ec=s(4308),ed=s(55765),eu=s(88598);function em(e){let{index:t,music:s,isSelected:i,onClick:l,onDelete:n,onUpdateMusic:o}=e,{user:d}=(0,a.useContext)(x.S),u=(0,a.useRef)((0,m.createClientComponentClient)()),{openModal:f,handleSetInfo:j}=(0,N.d)(),[y,b]=(0,a.useState)(!1),[_,k]=(0,a.useState)(!1),[S,A]=(0,a.useState)(!1),[E,D]=(0,a.useState)(!1),{isPlaying:O,audioUrl:z,playAudio:L,pauseAudio:F}=(0,v.c)(),M=async(e,t,s,r,a)=>{if(e.stopPropagation(),!d.has_access||null===d.has_access){j("Subscribe to download MP3","Subscribe to download your music"),f("upgrade");return}let i=p.Am.loading("Downloading MP3 file...",{duration:1/0,position:"top-right"});try{b(!0),k(!1);let e=await fetch(a);if(!e.ok)throw Error("Download failed");let t=await e.blob(),s=URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download="".concat(J(r),".mp3"),document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(s),p.Am.success("Download completed",{id:i})}catch(e){p.Am.error("Download failed",{id:i,description:"An unexpected error occurred"})}finally{p.Am.dismiss(i),b(!1)}},R=async(e,t)=>{if(e.stopPropagation(),!d.has_access||null===d.has_access){j("Subscribe to download WAV","Subscribe to download your music"),f("upgrade");return}let r=p.Am.loading("Downloading WAV file...",{duration:1/0,position:"top-right"});try{b(!0),k(!1);let e="/api/song/download/wav";"my"===s.provider&&(e="/api/song/download/wav/my");let a=await fetch(e,{method:"POST",body:JSON.stringify({url:s.audio,audio_id:s.original_id})});if(!a.ok){p.Am.error("download failed");return}let i=await a.blob();if(!i.type.includes("audio/")){p.Am.error("Invalid audio file format");return}let l=URL.createObjectURL(i),n=document.createElement("a");n.href=l,n.download="".concat(J(t),".wav"),document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(l),p.Am.success("".concat(t,".wav downloaded successfully"),{id:r})}catch(e){p.Am.error("Download failed",{id:r,description:"An unexpected error occurred"})}finally{p.Am.dismiss(r),b(!1)}},U=async(e,t)=>{e.stopPropagation();try{var s,r;let e=await fetch("/api/song/aligned-lyrics",{method:"POST",body:JSON.stringify({task_id:null==t?void 0:t.identify_id,music_id:null==t?void 0:t.original_id,provider:null==t?void 0:t.provider})});if(!e.ok){p.Am.error("download failed");return}let a=await e.json();if(!a.success)throw Error(a.message);let i=((null===(s=a.data)||void 0===s?void 0:s.aligned_words)||(null===(r=a.data)||void 0===r?void 0:r.alignedWords)||[]).map(e=>({word:e.word,success:e.success,start_s:e.start_s||e.startS,end_s:e.end_s||e.endS,p_align:e.p_align})).map(e=>"".concat(e.start_s," --> ").concat(e.end_s,"\n").concat(e.word,"\n\n")).join(""),l=new Blob([i],{type:"text/plain"}),n=URL.createObjectURL(l),o=document.createElement("a");o.href=n,o.download="".concat(J(t.title),".srt"),document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(n)}catch(e){p.Am.error(null==e?void 0:e.message)}},P=async(e,t)=>{e.stopPropagation(),navigator.clipboard.writeText(t.audio),p.Am.success("Copied Song Link")},I=async(e,t)=>{if(!(null==d?void 0:d.has_access)){j("Upgrade Required","Upgrade to change your music privacy, only visible to you"),f("upgrade");return}try{await (0,h.je)(u.current,e,t),o(e,{is_private:t}),p.Am.success("Privacy setting updated")}catch(e){p.Am.error("Failed to update privacy setting")}},T=async(e,t,s)=>{e.stopPropagation();try{await (0,h.St)(u.current,t,s),o(t,{is_like:s}),p.Am.success(s?"Added to favorites":"Removed from favorites")}catch(e){p.Am.error("Failed to update favorite status")}},Z=async()=>{await n(s.music_id),D(!1)},q=e=>{if(!e)return"Waiting...";let t=e.split(" - ");if(t.length<2)return(0,r.jsx)(r.Fragment,{children:e});let[s,a]=t;return(0,r.jsxs)(r.Fragment,{children:[s," - ",(0,r.jsx)("span",{className:"text-purple-500",children:a})]})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-full transition-colors duration-300 cursor-pointer\n          ".concat(i?"bg-white/10":"bg-transparent hover:bg-white/10"),children:(0,r.jsxs)("div",{className:"py-3 px-3 sm:px-4 flex items-center gap-3 md:gap-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("span",{className:"text-sm text-muted-foreground w-5 text-center block",children:t+1})}),(0,r.jsxs)("div",{className:"relative flex-shrink-0",onClick:l,children:[s.status===g.hU.FAILED?(0,r.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gray-600 rounded-lg flex items-center justify-center",children:(0,r.jsx)(eo.Z,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-200"})}):(0,r.jsx)("img",{src:s.image||"/logo.png",alt:s.title,className:"w-16 h-16 sm:w-20 sm:h-20 object-cover rounded-lg"}),i&&s.status===g.hU.SECOND_AUDIO&&(0,r.jsx)(C.z,{variant:"ghost",size:"icon",className:"absolute inset-0 m-auto w-8 h-8 flex items-center justify-center bg-black/60 rounded-full hover:bg-black/80 transition-colors",onClick:e=>{e.stopPropagation(),O&&z===s.audio?F():L(s.audio)},children:O&&z===s.audio?(0,r.jsx)(ea.Z,{className:"h-4 w-4 text-white"}):(0,r.jsx)(ei.Z,{className:"h-4 w-4 text-white"})})]}),(0,r.jsxs)("div",{className:"flex-grow min-w-0 flex flex-col justify-between py-0.5",children:[(0,r.jsxs)("div",{className:"space-y-1.5",onClick:l,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h3",{className:"text-sm font-medium leading-none",children:s.status===g.hU.FAILED?(0,r.jsx)("span",{className:"text-red-500",children:"Generation Failed"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"hidden md:inline",children:q(s.title)}),(0,r.jsx)("span",{className:"inline md:hidden",children:q(s.title)})]})}),s.extend>0&&(0,r.jsx)(w,{variant:"outline",className:"text-[10px] px-1.5 h-4 text-purple-400 border-purple-400/30 bg-purple-400/10",children:"Extend"}),s.is_upload&&(0,r.jsx)(w,{variant:"outline",className:"text-[10px] px-1.5 h-4 text-purple-400 border-purple-400/30 bg-purple-400/10",children:"Uploaded"})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1.5 items-center",children:s.status===g.hU.FAILED?(0,r.jsxs)("div",{className:"text-[10px] px-1.5 h-4 text-red-400 border-red-400/30 bg-red-400/10",children:["Reason: ",(0,c.SE)(s.error_message)]}):(0,r.jsx)(r.Fragment,{children:s.tags&&(0,r.jsxs)(r.Fragment,{children:[s.tags.split(",").slice(0,3).map((e,t)=>(0,r.jsxs)(w,{variant:"outline",className:"text-[10px] px-1.5 h-4",children:[(0,r.jsx)("span",{className:"hidden md:inline",children:e.trim()}),(0,r.jsx)("span",{className:"inline md:hidden",children:e.trim().length>30?"".concat(e.trim().substring(0,30),"..."):e.trim()})]},t)),s.tags.split(",").length>5&&(0,r.jsx)(w,{variant:"outline",className:"text-[10px] px-1.5 h-4",children:"..."})]})})})]}),s.status===g.hU.SECOND_AUDIO?(0,r.jsx)("div",{className:"flex items-center gap-1 mt-2",children:(0,r.jsxs)("div",{className:"flex items-center gap-1 sm:gap-1.5",children:[(0,r.jsx)(C.z,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0","aria-label":"Download music",onClick:()=>k(!0),children:(0,r.jsx)(X.Z,{className:"h-3.5 w-3.5"})}),(0,r.jsx)(C.z,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0","aria-label":"Share music",onClick:e=>P(e,s),children:(0,r.jsx)(ec.Z,{className:"h-3.5 w-3.5"})}),(0,r.jsx)(C.z,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 ".concat(s.is_like?"text-red-500":"text-gray-400 hover:text-red-400"),"aria-label":s.is_like?"Remove from favorites":"Add to favorites",onClick:e=>T(e,s.music_id,!s.is_like),children:(0,r.jsx)(ed.Z,{className:"h-3.5 w-3.5",fill:s.is_like?"#ef4444":"none"})}),(0,r.jsx)(en,{music:s,handlePrivateChange:I,setIsCommercialLicenseModalOpen:A,onDelete:n})]})}):s.status===g.hU.FAILED?(0,r.jsx)("div",{className:"flex items-center gap-1 mt-2",children:(0,r.jsx)("div",{className:"flex items-center gap-1 sm:gap-1.5",children:(0,r.jsx)(C.z,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>D(!0),children:(0,r.jsx)(eu.Z,{className:"h-3.5 w-3.5"})})})}):(0,r.jsx)("div",{className:"h-7 w-7 flex items-center justify-center mt-2",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-t-2 border-b-2 border-purple-500"})})]})]})}),(0,r.jsx)(Q,{isDownloadModalOpen:_,setIsDownloadModalOpen:k,onDownloadMp3:e=>M(e,s.task_id,s.music_id,s.title,s.audio),onDownloadWav:e=>R(e,s.title),onDownloadSrt:e=>U(e,s)}),(0,r.jsx)(G,{isDeleteModalOpen:E,setIsDeleteModalOpen:D,handleConfirmDelete:Z}),(0,r.jsx)(ee,{isCommercialLicenseModalOpen:S,setIsCommercialLicenseModalOpen:A})]})}function ex(){let{fetchFavoriteMusicList:e,fetchFailedMusicList:t}=function(){let e=(0,m.createClientComponentClient)(),{musicsList:t,currentMusicList:s,currentPage:r,taskTrigger:i,selectedMusic:l,handleSetIsLoading:n,handleSetMusicsList:o,handleSetRunningMusics:d,handleSetFavoriteMusics:v,handleSetFailedMusics:y}=(0,u.l)(),{handleSelectMusic:b}=j(),{user:w}=(0,a.useContext)(x.S);!function(){let e=(0,m.createClientComponentClient)(),{runningMusics:t,pollingMusicIds:s,handleSetCurrentPage:r,handleSetRunningMusics:i,appendNewMusic:l,handleSetPollingMusicIds:n}=(0,u.l)(),{user:o}=(0,a.useContext)(x.S),d=async t=>{if(!(!e||s.has(t)))try{for(;;){let s=await (0,h.dZ)(e,t);if(!s)break;if(s.status===g.hU.FAILED){p.Am.error((0,c.SE)(s.error_message||"")),i(e=>e.filter(e=>e.music_id!==s.music_id)),l({...s,error_message:(0,c.SE)(s.error_message||"")});break}if(s.status===g.hU.SECOND_AUDIO){i(e=>e.filter(e=>e.music_id!==s.music_id)),l(s),r(1);break}let a=new Date(s.created_at);if((new Date().getTime()-a.getTime())/6e4>30){await (0,h.RC)(e,[{music_id:s.music_id,status:g.hU.FAILED,error_message:"Music generation timed out after 30 minutes"}]),await (0,f.xi)(e,o.id,-g.A0),p.Am.error("Music generation timed out after 30 minutes"),i(e=>e.filter(e=>e.music_id!==s.music_id)),l({...s,status:g.hU.FAILED,error_message:"Music generation timed out after 30 minutes"});break}i(e=>e.map(e=>e.music_id===s.music_id?{...e,...s}:e)),await new Promise(e=>setTimeout(e,3e4))}}catch(e){console.error("Error updating your generating music:",null==e?void 0:e.message),p.Am.error("Failed to update your generating music. Please check your internet connection.")}};(0,a.useEffect)(()=>{t.filter(e=>!s.has(e.music_id)).forEach(e=>{n(e.music_id,!0),d(e.music_id)});let e=new Set(t.map(e=>e.music_id));s.forEach((t,s)=>{e.has(s)||n(s,!1)})},[t,s])}();let N=(0,a.useCallback)(async()=>{var a;if(!w||!e)return[];if(null===(a=t.get(r))||void 0===a?void 0:a.length)return t.get(r);try{n(!0);let t=await (0,h.wH)(e,w.id,r);return o(r,t),t}catch(e){return console.error("Failed to fetch music list:",e.message),p.Am.error("Failed to load your music, please try again"),s}finally{n(!1)}},[r,w]),C=(0,a.useCallback)(async()=>{if(!w||!e)return[];try{let t=(await (0,h.DC)(e,w.id)).reduce((e,t)=>(e.find(e=>e.music_id===t.music_id)||e.unshift(t),e),[]);return d(t),t}catch(e){return console.error("Failed to fetch running music list:",e),p.Am.error("Failed to load your generating music, please try again"),[]}},[w]),_=async()=>{if(!w||!e)return[];try{let t=(await (0,h.Lt)(e,w.id)).reduce((e,t)=>(e.find(e=>e.music_id===t.music_id)||e.unshift(t),e),[]);return v(t),t}catch(e){return console.error("Failed to fetch favorite music list:",e),p.Am.error("Failed to load your favorite music, please try again"),[]}},k=async()=>{if(!w||!e)return[];try{let t=(await (0,h.iN)(e,w.id)).reduce((e,t)=>(e.find(e=>e.music_id===t.music_id)||e.unshift(t),e),[]);return y(t),t}catch(e){return console.error("Failed to fetch failed music list:",e),p.Am.error("Failed to load your failed music, please try again"),[]}};return(0,a.useEffect)(()=>{(null==s?void 0:s.length)>0&&!l&&b(s[0])},[s,l,b]),(0,a.useEffect)(()=>{(async()=>{await N()})()},[N]),(0,a.useEffect)(()=>{(async()=>{await C()})()},[C,i]),{fetchCompleteMusicList:N,fetchRunningMusicList:C,fetchFavoriteMusicList:_,fetchFailedMusicList:k}}(),[s,i]=(0,a.useState)("success"),[l,n]=(0,a.useState)(""),{isLoading:o,totalPages:d,currentPage:v,runningMusics:b,favoriteMusics:w,failedMusics:N,currentMusicList:C,selectedMusic:_,handleSetCurrentPage:k}=(0,u.l)(),{handleSelectMusic:S,handleDeleteMusic:A,handleUpdateMusic:E}=j();(0,a.useEffect)(()=>{n(v.toString())},[v]);let D=()=>{let e=parseInt(l);isNaN(e)||k(Math.max(1,Math.min(e,d)))};return o?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-purple-500"})}):o||0!==C.length||1!==d?(0,r.jsxs)("div",{className:"h-full w-full flex flex-col no-scrollbar relative mt-2",children:[(0,r.jsx)("div",{className:"no-scrollbar",children:b.map((e,t)=>(0,r.jsx)(em,{index:t,music:e,isSelected:e.music_id===(null==_?void 0:_.music_id),onClick:()=>S(e),onDelete:()=>A(e.music_id),onUpdateMusic:(t,s)=>E(e.music_id,s)},e.music_id))}),(0,r.jsxs)("div",{className:"no-scrollbar",children:["success"===s&&C.map((e,t)=>(0,r.jsx)(em,{index:t,music:e,isSelected:e.music_id===(null==_?void 0:_.music_id),onClick:()=>S(e),onDelete:()=>A(e.music_id),onUpdateMusic:(t,s)=>E(e.music_id,s)},e.music_id)),"favorite"===s&&w.map((e,t)=>(0,r.jsx)(em,{index:t,music:e,isSelected:e.music_id===(null==_?void 0:_.music_id),onClick:()=>S(e),onDelete:()=>A(e.music_id),onUpdateMusic:(t,s)=>E(e.music_id,s)},e.music_id)),"failed"===s&&N.map((e,t)=>(0,r.jsx)(em,{index:t,music:e,isSelected:e.music_id===(null==_?void 0:_.music_id),onClick:()=>S(e),onDelete:()=>A(e.music_id),onUpdateMusic:(t,s)=>E(e.music_id,s)},e.music_id))]}),"success"===s&&(0,r.jsx)("div",{className:"py-2 w-full",children:(0,r.jsxs)("div",{className:"flex justify-center items-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>k(Math.max(1,v-1)),disabled:v<=1,className:"w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-700 transition-colors","aria-label":"Previous page",children:(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:l,onChange:e=>{let t=e.target.value;(""===t||/^\d+$/.test(t))&&n(t)},onBlur:D,onKeyDown:e=>{"Enter"===e.key&&D()},className:"w-10 h-10 text-center bg-transparent border-none focus:outline-none text-white","aria-label":"Page ".concat(v," of ").concat(d)})}),(0,r.jsx)("button",{onClick:()=>k(Math.min(d,v+1)),disabled:v>=d,className:"w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-700 transition-colors","aria-label":"Next page",children:(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M9 6L15 12L9 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})})]}):(0,r.jsx)("div",{className:"flex flex-col mt-10 items-center h-full",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("h3",{className:"text-xl font-medium text-gray-400 mb-3",children:"No music found"}),(0,r.jsx)(y.rU,{href:"/myworks",className:"text-2xl font-semibold bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent hover:from-blue-400 hover:to-purple-400 transition-colors",children:"Create your first song"})]})})}var eh=s(97577);let ep=a.forwardRef((e,t)=>{let{className:s,children:a,...i}=e;return(0,r.jsxs)(eh.fC,{ref:t,className:(0,c.cn)("relative overflow-hidden",s),...i,children:[(0,r.jsx)(eh.l_,{className:"h-full w-full rounded-[inherit]",children:a}),(0,r.jsx)(eg,{}),(0,r.jsx)(eh.Ns,{})]})});ep.displayName=eh.fC.displayName;let eg=a.forwardRef((e,t)=>{let{className:s,orientation:a="vertical",...i}=e;return(0,r.jsx)(eh.gb,{ref:t,orientation:a,className:(0,c.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...i,children:(0,r.jsx)(eh.q4,{className:"relative flex-1 rounded-full bg-slate-200 dark:bg-slate-800"})})});eg.displayName=eh.gb.displayName;var ef=s(31359),ev=s(22583),ej=s(40260),ey=s(35287),eb=s(98618);function ew(e){let{music:t}=e,{user:s}=(0,a.useContext)(x.S),[i,l]=(0,a.useState)(!1),[n,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),[m,h]=(0,a.useState)(!1),{selectedMusic:g}=(0,u.l)(),{isPlaying:f,togglePlay:j}=(0,v.c)(),{handleSetInfo:y,openModal:b,handleSetMusicMetadata:_}=(0,N.d)(),k=async()=>{if(!s.has_access){y("Upgrade Required","Please upgrade to a paid plan to merge your song."),b("upgrade");return}h(!0)};return g?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"w-full max-w-4xl mx-auto bg-background",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4 md:space-y-0 md:space-x-6 p-4 rounded-lg shadow-md",children:[(0,r.jsx)("div",{className:"flex flex-col items-center space-y-4 mb-2",children:(0,r.jsx)(eN,{imageUrl:g.image,title:g.title,isPlaying:f,onTogglePlay:j})}),(0,r.jsxs)("div",{className:"",children:[(0,r.jsx)("h2",{className:"flex items-center justify-center mt-2 text-2xl font-bold text-center md:text-left",children:g.title?g.title:"aisonggenerator.io"}),(0,r.jsx)("p",{className:"flex items-center justify-center mt-4 text-xs text-muted-foreground",children:new Date(g.created_at).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 justify-center mt-4",children:g.tags&&g.tags.split(",").map((e,t)=>(0,r.jsx)(w,{variant:"secondary",className:"text-xs px-2 py-1",children:e.trim()},t))}),(0,r.jsxs)("div",{className:"flex gap-2 items-center justify-center mt-4",children:[(!g.is_edit||"my"===g.provider)&&(0,r.jsxs)(C.z,{className:"flex items-center gap-2",onClick:()=>l(!0),children:["Edit Song",(0,r.jsx)(ef.Z,{className:"w-4 h-4"})]}),g.is_edit&&"my"!==g.provider&&(0,r.jsxs)(C.z,{className:"flex items-center gap-2 text-red-500",onClick:k,children:["Confirm Edit",(0,r.jsx)(ev.Z,{className:"w-4 h-4"})]}),(0,r.jsxs)(C.z,{className:"flex items-center gap-2",onClick:()=>{_({title:(null==g?void 0:g.title)||"",lyrics:(null==g?void 0:g.prompt)||"",styles:(null==g?void 0:g.tags)||""}),p.Am.success("Lyrics reused successfully")},children:["Reuse Lyrics",(0,r.jsx)(ej.Z,{className:"w-4 h-4"})]})]})]})]}),(0,r.jsx)("div",{className:"pt-4 px-4 relative",children:(0,r.jsx)(ep,{className:"relative z-20",children:(null==g?void 0:g.prompt)?(0,r.jsx)(eC,{lyrics:g.prompt,music_id:g.original_id,task_id:g.identify_id,provider:g.provider}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full space-y-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 text-muted-foreground animate-pulse flex items-center justify-center text-4xl",children:"♪"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground text-center px-4",children:["No lyrics available for this song. ",(0,r.jsx)("br",{})]})]})})})]}),(0,r.jsx)(e_,{isOpen:i,setIsOpen:l,music:g,setIsEditSongDetailDialogOpen:o,setIsEditSectionDialogOpen:d}),(0,r.jsx)(H,{isPaid:null==s?void 0:s.has_access,isDialogOpen:n,setIsDialogOpen:o}),(0,r.jsx)(es,{isOpen:m,onClose:()=>h(!1),music:g}),(0,r.jsx)(el,{isOpen:c,onClose:()=>d(!1),music:g})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full space-y-4 text-muted-foreground",children:[(0,r.jsx)("div",{className:"w-16 h-16 flex items-center justify-center text-5xl animate-pulse",children:"\uD83C\uDFB5"}),(0,r.jsx)("p",{className:"text-lg text-center px-4",children:"Select or generate a song to view its details"})]})}let eN=e=>{let{imageUrl:t,title:s,isPlaying:a,onTogglePlay:i}=e;return(0,r.jsx)("div",{className:"relative w-[280px] h-[280px] group cursor-pointer bg-[#2C2417] rounded-full p-6",onClick:i,children:(0,r.jsxs)("div",{className:"relative w-full h-full",children:[(0,r.jsx)("div",{className:"absolute inset-0 rounded-full bg-black/90"}),(0,r.jsx)("div",{className:"absolute inset-[15%] rounded-full overflow-hidden\n                        ".concat(a?"animate-spin":""),style:{animationDuration:"8s",animationTimingFunction:"linear",animationIterationCount:"infinite"},children:(0,r.jsx)("img",{src:t||"/logo.png",alt:s,className:"w-full h-full object-cover"})}),(0,r.jsx)("div",{className:"absolute top-0 right-[10%] w-[40%] h-[40%] transition-all duration-700 origin-top-right\n                        ".concat(a?"rotate-[-25deg]":"rotate-[-55deg]"),children:(0,r.jsx)("div",{className:"absolute top-0 right-0 w-full h-[2px] bg-white rounded-full origin-right transform rotate-[15deg]"})})]})})};function eC(e){let{lyrics:t,music_id:s,task_id:a,provider:i}=e,l=ek(t);return(0,r.jsx)("div",{className:"max-w-2xl mx-auto space-y-6 p-4 mb-10",children:l&&l.length>0?l.map((e,t)=>(0,r.jsxs)("section",{className:"mb-6 text-center",children:[(0,r.jsx)("h2",{className:"mb-2 text-sm uppercase ".concat(eS(e.type)),children:e.type}),(0,r.jsx)("div",{className:"space-y-1",children:e.lines.map((e,t)=>{let s=e.split(/\s+/);return(0,r.jsx)("p",{className:"text-gray-300 hover:text-purple-300 hover:font-medium transition-all duration-200 cursor-default text-center",children:s.map((e,t)=>(0,r.jsxs)("span",{className:"font-medium",children:[e,t<s.length-1?" ":""]},t))},t)})})]},t)):(0,r.jsx)("p",{className:"text-gray-300 text-center",children:t})})}function e_(e){let{isOpen:t,setIsOpen:s,music:a,setIsEditSongDetailDialogOpen:i,setIsEditSectionDialogOpen:l}=e,{handleSetEditMusic:n,openModal:o}=(0,N.d)();return(0,y.tv)(),(0,r.jsx)($.Vq,{open:t,onOpenChange:s,children:(0,r.jsxs)($.cZ,{className:"sm:max-w-[450px] bg-[#1C1C1C] border-zinc-800",children:[(0,r.jsx)($.fK,{children:(0,r.jsx)($.$N,{className:"text-md text-white",children:"Edit Your Song"})}),(0,r.jsxs)("div",{className:"flex justify-center gap-8 py-6",children:[(0,r.jsxs)(C.z,{onClick:()=>{if(s(!1),a.status!=g.hU.SECOND_AUDIO){p.Am.warning("Please wait for the song to be generated");return}i(!0)},variant:"outline",className:"flex flex-col items-center gap-2 h-auto py-4 px-8 text-white border-zinc-700 bg-zinc-800 text-white",children:[(0,r.jsx)(ey.Z,{className:"h-8 w-8"}),(0,r.jsx)("span",{children:"Edit Song Detail"})]}),(0,r.jsxs)(C.z,{onClick:()=>{if(n(a),a.status!=g.hU.SECOND_AUDIO){p.Am.warning("Please wait for the song to be generated");return}if("my"===a.provider){s(!1),l(!0);return}p.Am.warning("This feature is temporarily unavailable.")},variant:"outline",className:"flex flex-col items-center gap-2 h-auto py-4 px-8 text-white border-zinc-700 bg-zinc-800 text-white",children:[(0,r.jsx)(eb.Z,{className:"h-8 w-8"}),(0,r.jsx)("span",{children:"Edit Song Section"})]})]})]})})}let ek=e=>{let t=[],s={type:"",lines:[]};return e.split("\n").forEach(e=>{""!==e.trim()&&(e.startsWith("[")?(s.type&&t.push({...s}),s={type:e.replace(/[\[\]]/g,""),lines:[]}):/^[A-Za-z\s0-9]+:/.test(e)?(s.type&&t.push({...s}),s={type:e.replace(/:$/,""),lines:[]}):s.lines.push(e))}),s.type&&t.push(s),t},eS=e=>{let t=e.toLowerCase();return["intro","verse","pre","chorus","bridge","hook","refrain","interlude","breakdown","solo","rap","ad_lib","outro"].find(e=>t.includes(e)),"font-medium text-purple-500"};var eA=s(53255);function eE(){let{selectedMusic:e}=(0,u.l)(),t=[{id:0,label:"Song List",content:(0,r.jsx)("div",{className:"w-full flex flex-col items-center p-4 rounded-lg gap-3",children:(0,r.jsx)(ex,{})})},{id:1,label:"Song Details",content:(0,r.jsx)("div",{className:"w-full flex flex-col items-center gap-3 p-4",children:(0,r.jsx)(ew,{music:e})})},{id:2,label:"Create Song",content:(0,r.jsx)("div",{className:"w-full flex flex-col items-center p-4 rounded-lg gap-3",children:(0,r.jsx)(eA.Z,{})})}];return(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(d,{tabs:t})})}var eD=s(17981);function eO(){let{selectedMusic:e}=(0,u.l)();return(0,r.jsxs)("div",{className:"flex w-screen h-full bg-background text-foreground no-scrollbar",children:[(0,r.jsx)("div",{className:"w-[30%] p-1 border-r h-[calc(100vh-3.5rem)] border-border overflow-y-auto no-scrollbar",children:(0,r.jsx)(eD.default,{})}),(0,r.jsx)("div",{className:"w-[35%] 2xl:w-[40%] p-1 border-r h-[calc(100vh-3.5rem)] border-border overflow-y-auto no-scrollbar",children:(0,r.jsx)(ew,{music:e})}),(0,r.jsx)("div",{className:"w-[35%] 2xl:w-[30%] p-1 border-r h-[calc(100vh-3.5rem)] border-border overflow-y-auto no-scrollbar",children:(0,r.jsx)(ex,{})})]})}var ez=s(86681),eL=s(2529);function eF(){return(0,r.jsxs)("div",{className:"w-full h-screen",children:[(0,r.jsx)(eL.NavBar,{}),(0,r.jsx)("div",{className:"h-14"}),(0,r.jsx)("div",{className:"hidden xl:block",children:(0,r.jsx)(eO,{})}),(0,r.jsx)("div",{className:"xl:hidden block",children:(0,r.jsx)(eE,{})}),(0,r.jsx)(ez.default,{})]})}},44049:function(e,t,s){"use strict";s.d(t,{OL:function(){return g},_T:function(){return u},aR:function(){return o},f$:function(){return h},fY:function(){return m},le:function(){return f},xo:function(){return x},yT:function(){return p}});var r=s(61462),a=s(70265),i=s(3872),l=s(97711),n=s(29555);let o=i.fC;i.xz;let c=i.h_,d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.aV,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t})});d.displayName=i.aV.displayName;let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(d,{}),(0,r.jsx)(i.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-slate-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg dark:border-slate-800 dark:bg-slate-950",s),...a})]})});u.displayName=i.VY.displayName;let m=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};m.displayName="AlertDialogHeader";let x=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};x.displayName="AlertDialogFooter";let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold",s),...a})});h.displayName=i.Dx.displayName;let p=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.dk,{ref:t,className:(0,l.cn)("text-sm text-slate-500 dark:text-slate-400",s),...a})});p.displayName=i.dk.displayName;let g=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.aU,{ref:t,className:(0,l.cn)((0,n.d)(),s),...a})});g.displayName=i.aU.displayName;let f=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.$j,{ref:t,className:(0,l.cn)((0,n.d)({variant:"outline"}),"mt-2 sm:mt-0",s),...a})});f.displayName=i.$j.displayName}},function(e){e.O(0,[8791,3808,9706,8949,9184,1473,2713,7410,6865,7504,8841,2529,1323,5835,3552,2484,9642,1744],function(){return e(e.s=5140)}),_N_E=e.O()}]);